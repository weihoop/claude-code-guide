# Claude Code ä¸Šä¸‹æ–‡ç®¡ç†æœ€ä½³å®è·µ

## ğŸ“‹ ç›®å½•

- [é—®é¢˜èƒŒæ™¯](#é—®é¢˜èƒŒæ™¯)
- [æ ¸å¿ƒåŸç†](#æ ¸å¿ƒåŸç†)
- [æœ€ä½³è§£å†³æ–¹æ¡ˆ](#æœ€ä½³è§£å†³æ–¹æ¡ˆ)
- [æ¨èå·¥ä½œæµ](#æ¨èå·¥ä½œæµ)
- [é«˜çº§ä¼˜åŒ–æŠ€å·§](#é«˜çº§ä¼˜åŒ–æŠ€å·§)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## é—®é¢˜èƒŒæ™¯

### ä¸ºä»€ä¹ˆéœ€è¦é¢‘ç¹ä½¿ç”¨ `/compact`ï¼Ÿ

åœ¨ä½¿ç”¨ Claude Code æ—¶ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹æƒ…å†µï¼š

- ğŸ’° Token æ¶ˆè€—å¿«é€Ÿå¢é•¿
- ğŸ”„ é¢‘ç¹éœ€è¦æ‰§è¡Œ `/compact` å‘½ä»¤å‹ç¼©ä¸Šä¸‹æ–‡
- âš ï¸ ç³»ç»Ÿæç¤ºä¸Šä¸‹æ–‡æ¥è¿‘å®¹é‡é™åˆ¶
- ğŸ“‰ å·¥ä½œæ•ˆç‡ä¸‹é™ï¼Œå“åº”å˜æ…¢

### ä¸Šä¸‹æ–‡è¿‡å¤šçš„å¸¸è§åŸå› 

1. **å¤§å‹é¡¹ç›®è‡ªåŠ¨æ‰«æ**
   - å¯åŠ¨æ—¶æ‰«ææ•´ä¸ªé¡¹ç›®ç›®å½•
   - åŒ…å« `node_modules`ã€`.git` ç­‰å¤§å‹ç›®å½•
   - monorepo é¡¹ç›®é¦–æ¬¡å¯åŠ¨å¯èƒ½å ç”¨ 20K tokens

2. **é•¿ä¼šè¯ç§¯ç´¯**
   - å¤šè½®å¯¹è¯ä¸æ–­ç´¯ç§¯å†å²ä¿¡æ¯
   - æ¯æ¬¡ç”¨æˆ·è¾“å…¥å’Œ Claude å›å¤éƒ½å¢åŠ  token
   - ä½¿ç”¨ `@file` å¼•ç”¨ä¹Ÿä¼šåŠ è½½æ–‡ä»¶å†…å®¹

3. **é‡å¤è¯»å–ç›¸åŒæ–‡ä»¶**
   - åŒä¸€æ–‡ä»¶å¤šæ¬¡åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­
   - å¤§å‹ JSON/CSV æ–‡ä»¶ç‰¹åˆ«æ¶ˆè€— token
   - é¡¹ç›®ç»“æ„å’Œä¾èµ–ä¿¡æ¯é‡å¤åŠ è½½

4. **æ‰«æä¸å¿…è¦çš„æ–‡ä»¶**
   - æ„å»ºè¾“å‡ºç›®å½•ï¼ˆdistã€buildï¼‰
   - æ—¥å¿—æ–‡ä»¶å’Œä¸´æ—¶æ–‡ä»¶
   - æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šç­‰

---

## æ ¸å¿ƒåŸç†

### Claude Code çš„ä¸Šä¸‹æ–‡çª—å£

- **æ€»å®¹é‡**ï¼š200,000 tokensï¼ˆ"è®°å¿†"é™åˆ¶ï¼‰
- **å®é™…å¯ç”¨**ï¼šçº¦ 180K tokensï¼ˆå¤§å‹é¡¹ç›®æ‰£é™¤åˆå§‹æ‰«ææˆæœ¬ï¼‰
- **è‡ªåŠ¨å‹ç¼©è§¦å‘ç‚¹**ï¼šè¾¾åˆ° 95% å®¹é‡æ—¶
- **å¯é…ç½®**ï¼šé€šè¿‡ `/config` è°ƒæ•´è§¦å‘é˜ˆå€¼

### `/compact` vs `/clear` å¯¹æ¯”

| ç‰¹æ€§ | `/compact` | `/clear` |
|------|-----------|---------|
| **ç›®çš„** | å‹ç¼©å†å²ï¼Œä¿æŒä¸Šä¸‹æ–‡ | å®Œå…¨æ¸…ç©ºï¼Œé‡æ–°å¼€å§‹ |
| **Token é‡Šæ”¾** | 70-80% | 100% |
| **ä¿¡æ¯ä¿ç•™** | æ‘˜è¦å½¢å¼ | å®Œå…¨ä¸¢å¤± |
| **é€‚ç”¨åœºæ™¯** | åŒä¸€ä»»åŠ¡ç»§ç»­è¿›è¡Œ | å¼€å§‹æ–°çš„ç‹¬ç«‹ä»»åŠ¡ |
| **é£é™©** | å¯èƒ½ä¸¢å¤±ç»†èŠ‚ | ä¸¢å¤±æ‰€æœ‰å†å² |
| **æ¨èé¢‘ç‡** | è¾ƒå°‘ä½¿ç”¨ | ä»»åŠ¡é—´æ¸…ç† |

### å·¥ä½œåŸç†ç¤ºä¾‹

```
åŸå¯¹è¯å†å²ï¼ˆ30,000 tokensï¼‰ï¼š
  æ¶ˆæ¯1ï¼šè¯»å–é…ç½®æ–‡ä»¶ï¼ˆ500 tokensï¼‰
  æ¶ˆæ¯2ï¼šåˆ†æä»£ç ç»“æ„ï¼ˆ800 tokensï¼‰
  æ¶ˆæ¯3ï¼šå®ç°åŠŸèƒ½Aï¼ˆ1200 tokensï¼‰
  ...

æ‰§è¡Œ /compact åï¼ˆ2,000 tokensï¼‰ï¼š
  å‹ç¼©æ‘˜è¦ï¼š
  - å·²å®Œæˆï¼šä»»åŠ¡1ã€ä»»åŠ¡2ã€ä»»åŠ¡3
  - å…³é”®å†³ç­–ï¼šé€‰æ‹©äº†Xæ–¹æ¡ˆ
  - å¾…è§£å†³ï¼šé—®é¢˜Aã€é—®é¢˜B
```

---

## æœ€ä½³è§£å†³æ–¹æ¡ˆ

### ğŸ¥‡ æ–¹æ¡ˆ1ï¼šä¼˜å…ˆä½¿ç”¨ `/clear`ï¼ˆæ¨èï¼‰

**æ ¸å¿ƒåŸåˆ™**ï¼šä»»åŠ¡é—´æ¸…ç†ï¼Œè·å¾—æ–°é²œçš„ä¸Šä¸‹æ–‡

```bash
# âŒ ä¸æ¨èï¼šé¢‘ç¹å‹ç¼©
/compact  # åªé‡Šæ”¾ 70-80%ï¼Œä¼šä¸¢å¤±ç»†èŠ‚

# âœ… æ¨èï¼šä»»åŠ¡é—´æ¸…ç†
/clear    # å®Œå…¨æ¸…ç©ºï¼Œé‡Šæ”¾ 100% token
```

**ä½¿ç”¨æ—¶æœº**ï¼š
- âœ… å®Œæˆä¸€ä¸ªç‹¬ç«‹ä»»åŠ¡å
- âœ… å¼€å§‹æ–°åŠŸèƒ½å¼€å‘å‰
- âœ… åˆ‡æ¢åˆ°ä¸ç›¸å…³çš„å·¥ä½œæ—¶
- âš ï¸ `/compact` ä»…ç”¨äºåŒä¸€ä»»åŠ¡éœ€è¦ç»§ç»­æ—¶

### ğŸ¥ˆ æ–¹æ¡ˆ2ï¼šä»å…·ä½“ç›®å½•å¯åŠ¨

**å‡å°‘ä¸å¿…è¦çš„æ–‡ä»¶æ‰«æ**

```bash
# âŒ é”™è¯¯ï¼šä»é¡¹ç›®æ ¹ç›®å½•å¯åŠ¨
cd ~/projects/my-app
claude              # æ‰«ææ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ node_modules

# âœ… æ­£ç¡®1ï¼šä»å·¥ä½œç›®å½•å¯åŠ¨
cd ~/projects/my-app/src
claude              # åªæ‰«æ src ç›®å½•

# âœ… æ­£ç¡®2ï¼šæŒ‡å®šå…·ä½“è·¯å¾„
claude --path ~/projects/my-app/src

# âœ… æ­£ç¡®3ï¼šè¿›å…¥å­æ¨¡å—å·¥ä½œ
cd ~/projects/my-app/src/components
claude              # ä¸“æ³¨äºç»„ä»¶å¼€å‘
```

### ğŸ¥‰ æ–¹æ¡ˆ3ï¼šé…ç½® `.gitignore` æ’é™¤å¤§å‹ç›®å½•

**è®© Claude Code è‡ªåŠ¨è·³è¿‡ä¸å¿…è¦çš„ç›®å½•**

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæˆ–æ›´æ–° `.gitignore`ï¼š

```gitignore
# Claude Code é…ç½®æ–‡ä»¶
.claude.md
CLAUDE.md

# ä¾èµ–å’Œæ„å»ºäº§ç‰©
node_modules/
.git/
dist/
build/
.next/
out/
__pycache__/
*.pyc

# æµ‹è¯•å’Œè¦†ç›–ç‡
coverage/
.nyc_output/
.pytest_cache/

# æ—¥å¿—å’Œä¸´æ—¶æ–‡ä»¶
*.log
logs/
*.tmp
*.temp
temp/

# ç³»ç»Ÿæ–‡ä»¶
.DS_Store
Thumbs.db

# IDE é…ç½®
.vscode/
.idea/
*.swp
*.swo
```

### ğŸ¯ æ–¹æ¡ˆ4ï¼šä½¿ç”¨ç²¾ç¡®æŒ‡ä»¤

**é¿å…å…¨å±€æ‰«æï¼Œåªå¤„ç†å¿…è¦æ–‡ä»¶**

```bash
# âŒ ä½æ•ˆï¼šå¯¼è‡´å…¨é¡¹ç›®æ‰«æ
> å¸®æˆ‘å®¡æŸ¥ä¸€ä¸‹ä»£ç 
> æ£€æŸ¥é¡¹ç›®æœ‰æ²¡æœ‰é—®é¢˜
> ä¼˜åŒ–è¿™ä¸ªé¡¹ç›®çš„æ€§èƒ½

# âœ… é«˜æ•ˆï¼šåªå¤„ç†ç‰¹å®šæ–‡ä»¶
> å®¡æŸ¥ src/api/user.js çš„å®‰å…¨é—®é¢˜
> æ£€æŸ¥ package.json ä¸­è¿‡æœŸçš„ä¾èµ–
> ä¼˜åŒ– src/database/queries.js çš„æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
```

### ğŸ“Š æ–¹æ¡ˆ5ï¼šå®šæœŸç›‘æ§ token ä½¿ç”¨

```bash
# æŸ¥çœ‹å½“å‰ token æ¶ˆè€—æ˜ç»†
/cost

# æˆ–ä½¿ç”¨å¿«æ·å‘½ä»¤
ccusage
```

**è§£è¯»è¾“å‡º**ï¼š
- ğŸŸ¢ **0-60%**ï¼šToken å……è¶³ï¼Œæ­£å¸¸å·¥ä½œ
- ğŸŸ¡ **60-80%**ï¼šToken æ¥è¿‘é™åˆ¶ï¼Œè€ƒè™‘æ¸…ç†
- ğŸ”´ **80-100%**ï¼šç«‹å³æ¸…ç†ï¼Œå¦åˆ™ä¼šè§¦å‘è‡ªåŠ¨å‹ç¼©

**é¢„è­¦æœºåˆ¶**ï¼š
```markdown
- âš ï¸ **60%**ï¼šå¼€å§‹æ³¨æ„ token ä½¿ç”¨
- âš ï¸ **75%**ï¼šè€ƒè™‘ä»»åŠ¡é˜¶æ®µæ€§æ¸…ç†
- ğŸ”´ **85%**ï¼šåº”è¯¥ç«‹å³æ¸…ç†æˆ–ä½¿ç”¨ /compact
- ğŸ”´ **95%**ï¼šè§¦å‘è‡ªåŠ¨å‹ç¼©
```

---

## æ¨èå·¥ä½œæµ

### æ ‡å‡†å·¥ä½œæµç¨‹

```bash
# 1ï¸âƒ£ å¯åŠ¨é¡¹ç›®ï¼ˆä»å·¥ä½œç›®å½•ï¼‰
cd ~/projects/my-app/src
claude

# 2ï¸âƒ£ æ‰§è¡Œä»»åŠ¡1ï¼šå¼€å‘æ–°åŠŸèƒ½
> å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½
> /test                  # è¿è¡Œæµ‹è¯•
/cost                    # æŸ¥çœ‹ token ä½¿ç”¨ï¼šçº¦ 40%

# 3ï¸âƒ£ ä»»åŠ¡1å®Œæˆï¼Œæ¸…ç†ä¸Šä¸‹æ–‡
/clear                   # é‡Šæ”¾ 100% token

# 4ï¸âƒ£ æ‰§è¡Œä»»åŠ¡2ï¼šä¿®å¤ Bugï¼ˆæ–°ä¸Šä¸‹æ–‡ï¼‰
> ä¿®å¤æ”¯ä»˜æ¥å£è¶…æ—¶çš„bug
> /build                 # æ„å»ºé¡¹ç›®
/cost                    # é‡ç½®åˆ°çº¦ 20%

# 5ï¸âƒ£ ä»»åŠ¡2å®Œæˆï¼Œæ¸…ç†
/clear

# 6ï¸âƒ£ æ‰§è¡Œä»»åŠ¡3ï¼šæ€§èƒ½ä¼˜åŒ–
> ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
> /review                # ä»£ç å®¡æŸ¥
/cost                    # çº¦ 35%

# 7ï¸âƒ£ æ‰€æœ‰ä»»åŠ¡å®Œæˆ
/clear                   # å½»åº•æ¸…ç†
```

### é•¿ä¼šè¯ç®¡ç†ç­–ç•¥

**å½“å¿…é¡»åœ¨åŒä¸€ä»»åŠ¡ä¸­è¿ç»­å·¥ä½œæ—¶**ï¼š

```bash
# 1. å¼€å§‹å¤æ‚ä»»åŠ¡
> é‡æ„æ•´ä¸ªè®¤è¯ç³»ç»Ÿ
/cost                    # åˆå§‹ï¼š20%

# 2. å·¥ä½œè¿›è¡Œä¸­ï¼Œå®šæœŸæ£€æŸ¥
> å®Œæˆç”¨æˆ·æ¨¡å‹é‡æ„
/cost                    # è¾¾åˆ° 45%

> å®Œæˆ API ç«¯ç‚¹é‡æ„
/cost                    # è¾¾åˆ° 70%ï¼ˆâš ï¸ è­¦å‘Šï¼‰

# 3. è¾¾åˆ° 75% æ—¶ï¼Œä½¿ç”¨ compact è€Œé clear
/compact "ä¿ç•™æœªå®Œæˆçš„ä»»åŠ¡å’Œæ¶æ„å†³ç­–"
/cost                    # é™ä½åˆ° 25%

# 4. ç»§ç»­å·¥ä½œ
> å®Œæˆå‰ç«¯é›†æˆ
/cost                    # è¾¾åˆ° 50%

# 5. ä»»åŠ¡å®Œæˆ
/clear                   # å½»åº•æ¸…ç†
```

### åˆ†ä»»åŠ¡å¯åŠ¨å•ç‹¬ä¼šè¯

**ä¸æ¨èåšæ³•**ï¼š
```
åœ¨åŒä¸€çª—å£å†…è¿ç»­å·¥ä½œï¼š
- ä»»åŠ¡1ï¼šå¼€å‘åŠŸèƒ½Aï¼ˆå ç”¨ 40%ï¼‰
- ä»»åŠ¡2ï¼šä¿®å¤ bug Bï¼ˆç´¯ç§¯åˆ° 70%ï¼‰
- ä»»åŠ¡3ï¼šä¼˜åŒ–æ€§èƒ½Cï¼ˆç´¯ç§¯åˆ° 95%ï¼Œè¢«è¿« compactï¼‰
```

**æ¨èåšæ³•**ï¼š
```bash
# ä»»åŠ¡1å®Œæˆå
/clear

# æˆ–ç›´æ¥å¼€å¯æ–°çª—å£/ä¼šè¯
cd project && claude

# æ¯ä¸ªä»»åŠ¡æœ‰ç‹¬ç«‹çš„ã€æ–°é²œçš„ 200K token é¢„ç®—
```

---

## é«˜çº§ä¼˜åŒ–æŠ€å·§

### æŠ€å·§1ï¼šå¤§æ–‡ä»¶å¤„ç†ç­–ç•¥

**å¤„ç†å¤§å‹æ—¥å¿—æˆ–æ•°æ®æ–‡ä»¶**ï¼š

```bash
# âŒ é”™è¯¯ï¼šç›´æ¥è¯»å–å¤§æ–‡ä»¶
> åˆ†æ error.log æ–‡ä»¶ï¼ˆ10MBï¼Œä¼šæ¶ˆè€—å¤§é‡ tokenï¼‰

# âœ… æ­£ç¡®1ï¼šå…ˆç­›é€‰å†åˆ†æ
grep "ERROR" error.log | tail -100 > /tmp/recent-errors.txt
> åˆ†æè¿™ä¸ªé”™è¯¯æ‘˜è¦æ–‡ä»¶

# âœ… æ­£ç¡®2ï¼šä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·é¢„å¤„ç†
tail -1000 application.log | grep "CRITICAL" > /tmp/critical.log
> åˆ†æè¿™äº›å…³é”®é”™è¯¯

# âœ… æ­£ç¡®3ï¼šæŒ‡å®šè¯»å–èŒƒå›´
> åªè¯»å– data.json çš„å‰ 50 è¡Œ
```

### æŠ€å·§2ï¼šåœ¨ `.claude.md` ä¸­æ·»åŠ ä¼˜åŒ–é…ç½®

åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `.claude.md` ä¸­è®°å½•æœ€ä½³å®è·µï¼š

```markdown
## Claude Code Token ç®¡ç†è§„èŒƒ

### å¯åŠ¨æ–¹å¼
\`\`\`bash
# ä» src ç›®å½•å¯åŠ¨ï¼Œå‡å°‘æ–‡ä»¶æ‰«æ
cd src && claude

# æˆ–ä»ç‰¹å®šæ¨¡å—å¯åŠ¨
cd src/api && claude
\`\`\`

### æ¸…ç†è§„åˆ™
- **å®ŒæˆåŠŸèƒ½æ¨¡å—**ï¼šç«‹å³ `/clear`
- **å¼€å§‹æ–°ä»»åŠ¡**ï¼šæ‰§è¡Œ `/clear`
- **Token è¾¾åˆ° 70%**ï¼šè€ƒè™‘ `/clear` æˆ– `/compact`
- **Token è¾¾åˆ° 85%**ï¼šå¿…é¡»æ¸…ç†

### æ–‡ä»¶æ‰«ææ’é™¤
ç¡®ä¿ `.gitignore` åŒ…å«ï¼š
- `node_modules/`
- `dist/`, `build/`
- `.next/`, `out/`
- `coverage/`
- `*.log`

### é•¿ä¼šè¯ç®¡ç†
- æ¯ä¸ªç‹¬ç«‹åŠŸèƒ½å®Œæˆåæ¸…ç†
- ä¸åœ¨åŒä¸€ä¼šè¯ä¸­å¤„ç†æ— å…³ä»»åŠ¡
- å¤§å‹é‡æ„ä»»åŠ¡åˆ†é˜¶æ®µï¼Œä¸­é€”ä½¿ç”¨ `/compact`
```

### æŠ€å·§3ï¼šä»»åŠ¡åˆ†å±‚å’Œæ¸…ç†

```
ä»»åŠ¡å±‚çº§ç»“æ„ï¼š

é¡¹ç›®å¼€å‘
â”œâ”€ ä»»åŠ¡1ï¼šåŠŸèƒ½å¼€å‘
â”‚  â”œâ”€ è¯»å–éœ€æ±‚æ–‡æ¡£
â”‚  â”œâ”€ è®¾è®¡æ•°æ®æ¨¡å‹
â”‚  â”œâ”€ å®ç° API
â”‚  â””â”€ /clear âœ“
â”‚
â”œâ”€ ä»»åŠ¡2ï¼šBug ä¿®å¤ï¼ˆæ–°ä¸Šä¸‹æ–‡ï¼‰
â”‚  â”œâ”€ è¯»å– bug æŠ¥å‘Š
â”‚  â”œâ”€ å®šä½é—®é¢˜ä»£ç 
â”‚  â”œâ”€ ä¿®å¤å¹¶æµ‹è¯•
â”‚  â””â”€ /clear âœ“
â”‚
â””â”€ ä»»åŠ¡3ï¼šæ€§èƒ½ä¼˜åŒ–ï¼ˆæ–°ä¸Šä¸‹æ–‡ï¼‰
   â”œâ”€ åˆ†ææ€§èƒ½æŒ‡æ ‡
   â”œâ”€ ä¼˜åŒ–ä»£ç 
   â”œâ”€ éªŒè¯æ”¹è¿›æ•ˆæœ
   â””â”€ å®Œæˆ
```

### æŠ€å·§4ï¼šä½¿ç”¨ `/memory` ä¿å­˜é‡è¦ä¿¡æ¯

**å‡å°‘é‡å¤è¾“å…¥ï¼Œé™ä½ token æ¶ˆè€—**

```bash
# å°†ç»å¸¸é‡å¤çš„ä¿¡æ¯å›ºåŒ–åˆ°è®°å¿†ä¸­
/memory "è¿™ä¸ªé¡¹ç›®ä½¿ç”¨ Next.js 15 + TypeScript + PostgreSQL"

/memory "å·²å»ºç«‹çš„æ¶æ„å†³ç­–ï¼š
- ä½¿ç”¨ JWT è®¤è¯è€Œä¸æ˜¯ Session
- æ•°æ®åº“ ORM ä½¿ç”¨ Prisma
- å‰ç«¯çŠ¶æ€ç®¡ç†ä½¿ç”¨ Zustand
- API è·¯ç”±ä½¿ç”¨ App Router"

/memory "å¼€å‘è§„èŒƒï¼š
- æ‰€æœ‰ API éœ€è¦é”™è¯¯å¤„ç†
- æ•°æ®åº“æŸ¥è¯¢ä½¿ç”¨äº‹åŠ¡
- ç»„ä»¶éµå¾ªåŸå­è®¾è®¡æ¨¡å¼"
```

**æ•ˆæœ**ï¼š
- åç»­å¯¹è¯ç›´æ¥ä½¿ç”¨è®°å¿†ï¼Œä¸ç”¨é‡å¤è¾“å…¥
- å‡å°‘ token æ¶ˆè€— 15-25%
- ä¿æŒä¸Šä¸‹æ–‡ä¸€è‡´æ€§

### æŠ€å·§5ï¼šæ™ºèƒ½ä½¿ç”¨ `/compact` çš„æŒ‡ä»¤

**å¸¦æŒ‡ä»¤çš„å‹ç¼©**æ›´æœ‰é’ˆå¯¹æ€§ï¼š

```bash
# åŸºç¡€å‹ç¼©
/compact

# å¸¦æŒ‡ä»¤çš„å‹ç¼© - å‘Šè¯‰ Claude ä¿ç•™ä»€ä¹ˆ
/compact "ä¿ç•™æ‰€æœ‰æœªè§£å†³çš„é—®é¢˜å’Œå¾…åŠä»»åŠ¡"

/compact "åªä¿ç•™æ¶æ„å†³ç­–å’ŒæŠ€æœ¯é€‰å‹ï¼Œåˆ é™¤å®ç°ç»†èŠ‚"

/compact "ä¿ç•™æ‰€æœ‰ä»£ç å®¡æŸ¥å»ºè®®å’Œæ”¹è¿›ç‚¹"

/compact "ä¿ç•™æµ‹è¯•å¤±è´¥çš„ä¿¡æ¯å’Œè°ƒè¯•è¿‡ç¨‹"
```

### æŠ€å·§6ï¼šä½¿ç”¨ MCP å‡å°‘ç›´æ¥æ–‡ä»¶è¯»å–

**é…ç½® MCP æœåŠ¡å™¨å¤„ç†ç‰¹å®šåŠŸèƒ½**ï¼š

åœ¨ `~/.claude/config.json` ä¸­é…ç½®ï¼š

```json
{
  "mcpServers": {
    "filesystem": {
      "command": "mcp-server-filesystem",
      "args": ["/Users/you/projects"],
      "env": {}
    }
  }
}
```

**ä¼˜åŠ¿**ï¼š
- MCP æœåŠ¡å™¨å¤„ç†æ–‡ä»¶ç®¡ç†
- Claude åªè·å–éœ€è¦çš„ä¿¡æ¯
- å‡å°‘ç›´æ¥æ–‡ä»¶æ“ä½œçš„ token æ¶ˆè€—

---

## å¸¸è§é—®é¢˜

### Q1: `/compact` å’Œ `/clear` åº”è¯¥é€‰æ‹©å“ªä¸ªï¼Ÿ

**æ¨èå†³ç­–æ ‘**ï¼š

```
éœ€è¦ç»§ç»­å½“å‰ä»»åŠ¡ï¼Ÿ
â”œâ”€ æ˜¯ â†’ Token ä½¿ç”¨ç‡ > 80%ï¼Ÿ
â”‚  â”œâ”€ æ˜¯ â†’ /compact "ä¿ç•™å…³é”®ä¿¡æ¯"
â”‚  â””â”€ å¦ â†’ ç»§ç»­å·¥ä½œ
â”‚
â””â”€ å¦ â†’ /clearï¼ˆå¼€å§‹æ–°ä»»åŠ¡ï¼‰
```

**ç®€å•åŸåˆ™**ï¼š
- ğŸ’¡ **ä»»åŠ¡é—´**ï¼šä½¿ç”¨ `/clear`
- ğŸ’¡ **ä»»åŠ¡å†…**ï¼šToken é«˜æ—¶ç”¨ `/compact`

### Q2: `/compact` ä¼šä¸¢å¤±ä»€ä¹ˆä¿¡æ¯ï¼Ÿ

**å¯èƒ½ä¸¢å¤±çš„ç»†èŠ‚**ï¼š
- å…·ä½“çš„ä»£ç å®ç°ç»†èŠ‚
- ä¸­é—´çš„è°ƒè¯•è¿‡ç¨‹
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
- è®¨è®ºçš„å¤šä¸ªå¤‡é€‰æ–¹æ¡ˆ

**ä¿ç•™çš„æ ¸å¿ƒä¿¡æ¯**ï¼š
- å·²å®Œæˆçš„ä»»åŠ¡åˆ—è¡¨
- å…³é”®å†³ç­–å’Œæ¶æ„é€‰æ‹©
- æœªè§£å†³çš„é—®é¢˜
- å¾…åŠä»»åŠ¡

**æœ€ä½³å®è·µ**ï¼š
- é‡è¦ä¿¡æ¯ç”¨ `/memory` å›ºåŒ–
- å…³é”®å†³ç­–è®°å½•åˆ° `.claude.md`
- ä½¿ç”¨å¸¦æŒ‡ä»¤çš„ `/compact`

### Q3: å¦‚ä½•ç›‘æ§ token ä½¿ç”¨æƒ…å†µï¼Ÿ

**å®æ—¶ç›‘æ§**ï¼š
```bash
# æŸ¥çœ‹è¯¦ç»†ä½¿ç”¨æƒ…å†µ
/cost

# ç®€æ´è§†å›¾
ccusage
```

**é¢„è­¦è®¾ç½®**ï¼š

åœ¨ `.claude.md` ä¸­æ·»åŠ ï¼š
```markdown
## Token ç®¡ç†å‘Šè­¦

- ğŸŸ¢ **0-60%**ï¼šæ­£å¸¸å·¥ä½œ
- ğŸŸ¡ **60-75%**ï¼šå¼€å§‹æ³¨æ„ï¼Œè€ƒè™‘é˜¶æ®µæ€§æ¸…ç†
- ğŸŸ  **75-85%**ï¼šå»ºè®®æ¸…ç†æˆ–å‹ç¼©
- ğŸ”´ **85-95%**ï¼šå¿…é¡»ç«‹å³æ¸…ç†
- ğŸ”´ **95%+**ï¼šè§¦å‘è‡ªåŠ¨å‹ç¼©
```

### Q4: å¤§å‹é¡¹ç›®å¦‚ä½•ä¼˜åŒ–åˆå§‹æ‰«æï¼Ÿ

**æ–¹æ³•1ï¼šä»å­ç›®å½•å¯åŠ¨**
```bash
cd src/api && claude
```

**æ–¹æ³•2ï¼šé…ç½® `.gitignore`**
```gitignore
node_modules/
.git/
dist/
build/
```

**æ–¹æ³•3ï¼šä½¿ç”¨ `.claudeignore`**ï¼ˆå¦‚æœæ”¯æŒï¼‰
```
# é¢å¤–æ’é™¤ç›®å½•
tests/fixtures/
docs/
examples/
```

**æ–¹æ³•4ï¼šåˆ†æ¨¡å—å·¥ä½œ**
```bash
# åç«¯å¼€å‘
cd backend && claude

# å‰ç«¯å¼€å‘
cd frontend && claude
```

### Q5: å¦‚ä½•å¤„ç†å¤šä¸ªä¸ç›¸å…³çš„ä»»åŠ¡ï¼Ÿ

**æ¨èæ–¹æ¡ˆ**ï¼šæ¯ä¸ªä»»åŠ¡å¼€å¯æ–°ä¼šè¯

```bash
# ä»»åŠ¡1ï¼šå¼€å‘åŠŸèƒ½
claude
> å®ç°ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
/clear

# ä»»åŠ¡2ï¼šä¿®å¤ Bugï¼ˆæ–°ä¼šè¯ï¼‰
claude
> ä¿®å¤ç™»å½•è¶…æ—¶é—®é¢˜
/clear

# ä»»åŠ¡3ï¼šæ€§èƒ½ä¼˜åŒ–ï¼ˆæ–°ä¼šè¯ï¼‰
claude
> ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
/clear
```

**ä¸æ¨è**ï¼šåœ¨åŒä¸€ä¼šè¯å¤„ç†æ‰€æœ‰ä»»åŠ¡ï¼ˆå¯¼è‡´ token å †ç§¯ï¼‰

### Q6: `/compact` åå‘ç°ä¿¡æ¯ä¸¢å¤±æ€ä¹ˆåŠï¼Ÿ

**é¢„é˜²æªæ–½**ï¼š

1. **ä½¿ç”¨å¸¦æŒ‡ä»¤çš„å‹ç¼©**
   ```bash
   /compact "ä¿ç•™æ‰€æœ‰æœªå®Œæˆçš„ä»»åŠ¡å’Œæ¶æ„å†³ç­–"
   ```

2. **é‡è¦ä¿¡æ¯æå‰ä¿å­˜**
   ```bash
   /memory "å…³é”®å†³ç­–ï¼šé€‰æ‹© PostgreSQLï¼Œä½¿ç”¨ Prisma ORM"
   ```

3. **è®°å½•åˆ°é¡¹ç›®æ–‡æ¡£**
   - æ›´æ–° `.claude.md`
   - è®°å½•åˆ° `SPEC.md`
   - æ·»åŠ æ³¨é‡Šåˆ°ä»£ç ä¸­

**è¡¥æ•‘æªæ–½**ï¼š

å¦‚æœä¿¡æ¯å·²ä¸¢å¤±ï¼š
- é‡æ–°è¯»å–ç›¸å…³æ–‡ä»¶æ¢å¤ä¸Šä¸‹æ–‡
- æŸ¥çœ‹ git å†å²å’Œæäº¤ä¿¡æ¯
- æ£€æŸ¥é¡¹ç›®æ–‡æ¡£å’Œæ³¨é‡Š

---

## é¢„æœŸæ•ˆæœ

é€šè¿‡å®æ–½è¿™äº›æœ€ä½³å®è·µï¼Œä½ å¯ä»¥ï¼š

âœ… **å‡å°‘ 80% ä»¥ä¸Šçš„ `/compact` ä½¿ç”¨**
âœ… **æ¯ä¸ªä»»åŠ¡è·å¾—å®Œæ•´çš„ 200K token é¢„ç®—**
âœ… **é¿å…ä¿¡æ¯ä¸¢å¤±**ï¼ˆæ¸…ç©ºæ¯”å‹ç¼©æ›´å¯æ§ï¼‰
âœ… **æé«˜å·¥ä½œæ•ˆç‡**ï¼ˆå¹²å‡€çš„ä¸Šä¸‹æ–‡ï¼Œå¿«é€Ÿå“åº”ï¼‰
âœ… **é™ä½æˆæœ¬**ï¼ˆåˆç†åˆ†é… token é¢„ç®—ï¼‰

---

## å¿«é€Ÿå‚è€ƒå¡ç‰‡

### ğŸ¯ æ ¸å¿ƒå»ºè®®ï¼ˆåŠ¡å¿…éµå¾ªï¼‰

1. **ä»»åŠ¡é—´ä½¿ç”¨ `/clear`** - è€Œä¸æ˜¯ä¾èµ– `/compact`
2. **ä»å…·ä½“ç›®å½•å¯åŠ¨** - é¿å…æ‰«ææ•´ä¸ªé¡¹ç›®
3. **é…ç½® `.gitignore`** - æ’é™¤ä¸å¿…è¦çš„å¤§å‹ç›®å½•
4. **ä½¿ç”¨ç²¾ç¡®æŒ‡ä»¤** - åªå¤„ç†å¿…è¦çš„æ–‡ä»¶
5. **å®šæœŸç›‘æ§ token** - ä½¿ç”¨ `/cost` æ£€æŸ¥

### ğŸ“Š å‘½ä»¤é€ŸæŸ¥è¡¨

| å‘½ä»¤ | ç”¨é€” | ä½¿ç”¨é¢‘ç‡ |
|------|------|---------|
| `/clear` | å®Œå…¨æ¸…ç©ºä¸Šä¸‹æ–‡ | ä»»åŠ¡é—´ |
| `/compact` | å‹ç¼©ä¸Šä¸‹æ–‡å†å² | é•¿ä¼šè¯å†… |
| `/cost` | æŸ¥çœ‹ token ä½¿ç”¨ | ç»å¸¸ |
| `/memory` | ä¿å­˜é‡è¦ä¿¡æ¯ | å¼€å§‹æ—¶ |

### âš¡ å¿«é€Ÿå†³ç­–

```
å®Œæˆä¸€ä¸ªä»»åŠ¡ï¼Ÿ â†’ /clear
å¼€å§‹æ–°ä»»åŠ¡ï¼Ÿ â†’ /clear
Token > 80%ï¼Ÿ â†’ /clear æˆ– /compact
ç»§ç»­å½“å‰ä»»åŠ¡ï¼Ÿ â†’ ç»§ç»­å·¥ä½œï¼ˆå¿…è¦æ—¶ /compactï¼‰
```

---

## ç›¸å…³èµ„æº

- [Claude Code å®˜æ–¹æ–‡æ¡£](https://docs.claude.com/)
- [ä¸Šä¸‹æ–‡çª—å£ç®¡ç†](https://docs.claude.com/en/docs/build-with-claude/context-windows)
- [æˆæœ¬ä¼˜åŒ–æŒ‡å—](https://www.hats-land.com/archives/skills/2025-claude-code-usage-guide.html)
- [å‘½ä»¤å‚è€ƒ](../reference/commands.md)

---

**æœ€åæ›´æ–°**: 2025-12-13
**é€‚ç”¨ç‰ˆæœ¬**: Claude Code 1.0+
